syntax = "proto3";
package dev.yanshouwang.bluetooth_low_energy;

message Message {
  MessageCategory category = 1;
  oneof value {
      BluetoothState state = 2;
      Discovery discovery = 3;
      bool scanning = 4;
      ConnectionLost connectionLost = 5;
      GattCharacteristicValue characteristicValue = 6;
  }
}

message StartDiscoveryArguments {
  repeated string services = 1;
}

message Discovery {
  string device = 1;
  sint32 rssi = 2;
  map<uint32, bytes> advertisements = 3;
}

message GATT {
  int32 mtu = 1;
  repeated GattService services = 2;
}

message GattService {
  string uuid = 1;
  repeated GattCharacteristic characteristics = 2;
}

message GattCharacteristic {
  string uuid = 1;
  repeated GattDescriptor descriptors = 2;
  bool canRead = 3;
  bool canWrite = 4;
  bool canWriteWithoutResponse = 5;
  bool canNotify = 6;
}

message GattDescriptor {
  string uuid = 1;
}

message ConnectionLost {
  string device = 1;
  int32 error_code = 2;
}

message GattCharacteristicReadArguments {
  string device = 1;
  string service = 2;
  string characteristic = 3;
}

message GattCharacteristicWriteArguments {
  string device = 1;
  string service = 2;
  string characteristic = 3;
  bytes value = 4;
  bool withoutResponse = 5;
}

message GattCharacteristicNotifyArguments{
  string device = 1;
  string service = 2;
  string characteristic = 3;
  bool state = 4;
}

message GattCharacteristicValue {
  string device = 1;
  string service = 2;
  string characteristic = 3;
  bytes value = 4;
}

message GattDescriptorReadArguments {
  string device = 1;
  string service = 2;
  string characteristic = 3;
  string descriptor = 4;
}

message GattDescriptorWriteArguments {
  string device = 1;
  string service = 2;
  string characteristic = 3;
  string descriptor = 4;
  bytes value = 5;
}

enum MessageCategory {
    BLUETOOTH_STATE = 0;
    CENTRAL_START_DISCOVERY = 1;
    CENTRAL_STOP_DISCOVERY = 2;
    CENTRAL_DISCOVERED = 3;
    CENTRAL_SCANNING = 4;
    CENTRAL_CONNECT = 5;
    GATT_DISCONNECT = 6;
    GATT_CONNECTION_LOST = 7;
    GATT_CHARACTERISTIC_READ = 8;
    GATT_CHARACTERISTIC_WRITE = 9;
    GATT_CHARACTERISTIC_NOTIFY = 10;
    GATT_DESCRIPTOR_READ = 11;
    GATT_DESCRIPTOR_WRITE = 12;
}

enum BluetoothState {
  UNKNOWN = 0;
  RESETTING = 1;
  UNSUPPORTED = 2;
  UNAUTHORIZED = 3;
  POWERED_OFF = 4;
  POWERED_ON = 5;
}